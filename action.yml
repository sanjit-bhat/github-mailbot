name: 'GitHub commit emailer'
description: 'Send emails whenever a push event happens'

inputs:
  host:
    required: true
    type: string
  port:
    required: true
    type: string
  from:
    required: true
    type: string
  to:
    required: true
    type: string
  password:
    required: true

runs:
  using: 'composite'
  steps:
    - uses: actions/checkout@v4
      with:
        repository: 'theZiz/aha'
        ref: '5eaec96aae98274d1d86b431b9d426d50a023fbc'
    - uses: actions/checkout@v4
      with:
        repository: 'dandavison/delta'
        ref: 'v0.18.2'
    - run: make
      shell: bash
      working-directory: ./aha
    - run: ls -lR ${{ github.action_path }}
      shell: bash
    - uses: actions/checkout@v4
    - uses: actions/setup-go@v5
      with:
        cache: false
    - run: go run main.go
      shell: bash
      env:
        MAILBOT_HOST: ${{ inputs.host }}
        MAILBOT_PORT: ${{ inputs.port }}
        MAILBOT_FROM: ${{ inputs.from }}
        MAILBOT_TO: ${{ inputs.to }}
        MAILBOT_PASSWORD: ${{ inputs.password }}
        MAILBOT_GH_EVENT: ${{ toJSON(github.event) }}
